plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
for(ii in seq(0,20,10))
lines(
t.anc-ii+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .8
k.G = 15
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
for(ii in c(10,20))
lines(
t.anc-ii+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .8
k.G = 15
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
for(ii in c(15,30))
lines(
t.anc-ii+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .8
k.G = 15
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .8
k.G = 25
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = 1
k.G = 20
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .8
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.domain+t.dsc,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.025),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.anc+10+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
lines(t.anc+10+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+10+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+10,lty=2)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-10+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-10,lty=2)
lines(t.anc+10+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+10,lty=2)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+10+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+10,lty=2)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i',xlab='Time')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i',xlab='Time',ylab='',yaxt='off')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i',xlab='Time',ylab='')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
?convolve
x
x=seq(0,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
dgamma(-x,k.I,theta.I)))
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i',xlab='Time',ylab='')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
x=seq(0,20,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
dgamma(-x,k.I,theta.I)))
plot(dgamma(-x,k.I,theta.I))
plot(dgamma(x,k.I,theta.I))
x=seq(0,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
dgamma(-x,k.I,theta.I)))
x=seq(0,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I))))
plot(dgamma(x,k.I,theta.I))
plot(rev(dgamma(x,k.I,theta.I)))
x=seq(0,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I))))
x=seq(-100,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I))))
x=seq(-100,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
type='filter'))
x=seq(0,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
type='filter'))
x=seq(0,100,.1)
plot(
#   x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
type='filter'))
x=seq(0,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
type='circular'))
x=seq(-100,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
type='circular'))
x=seq(-100,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
type='open'))
plot(rev(dgamma(x,k.I,theta.I)))
x=seq(-100,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=TRUE))
x=seq(-100,100,.1)
plot(
x,
convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE))
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
length(x)
length(y)
y[1]
y[2001]
x=seq(0,100,.1)
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
plot(y)
x=seq(-100,100,.1)
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
y=c(y[ceiling(length(y)/2):length(y)],y[1:(ceiling(length(y)/2)-1)])
plot(x,y)
plot(x,y,type='l')
x=seq(-100,100,.1)
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
y=convolve(
y,
dgamma(x,k.G,theta.G),
conj=FALSE)
plot(x,y,type='l')
x=t.domain
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
y=convolve(
y,
dgamma(x,k.G,theta.G),
conj=FALSE)
plot(x,y)
x=seq(-100,100,.1)
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
y=convolve(
y,
dgamma(x,k.G,theta.G),
conj=FALSE)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
x=seq(-100,100,.1)
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
y=convolve(
y,
dgamma(x,k.G,theta.G),
conj=FALSE)
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i',xlab='Time',ylab='')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
lines(t.anc+x,y)
normalize = function(x){x/sum(x)}
t.anc = 50
t.dsc = 70
theta.I = .2
k.I = 3
theta.G = .7
k.G = 18
x=seq(-100,100,.1)
y=convolve(
dgamma(x,k.I,theta.I),
rev(dgamma(x,k.I,theta.I)),
conj=FALSE)
y=convolve(
y,
dgamma(x,k.G,theta.G),
conj=FALSE)
t.n = 500
t.domain = seq(t.anc-50,t.dsc+50,length.out=t.n)
plot(-100,-100,xlim=range(t.domain),ylim=c(0,.017),xaxs='i',yaxs='i',xlab='Time',ylab='')
abline(v=c(t.anc,t.dsc))
lines(t.anc-t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
lines(t.anc-15+t.domain,normalize(dgamma(t.domain,k.G,theta.G)))
abline(v=t.anc-15,lty=2)
lines(t.anc+13+t.domain,normalize(dgamma(t.domain,k.I,theta.I)))
abline(v=t.anc+13,lty=2)
lines(t.anc+x,normalize(y))
zones
gmi
setwd('~/Dropbox/CHIKFILA/code/')
source('loadData.R')
jpeg('../output/beta_temp_precip_hires.jpeg',width=6.5,height=5.75,units='in',res=1000)
# pdf('../output/beta_temp_precip.pdf',width=6.5,height=5.75)
par(mar=c(3.5,3.5,1,.5),oma=rep(0,4))
image.plot(
x=seq(0,450,length.out=200),
y=seq(15,35,length.out=200),
z=matrix(
calc.beta(
rep(seq(15,35,length.out=200),each=200),
rep(seq(0,450,length.out=200),times=200)),200,200),
xlab='',
ylab='',
las=1,
lwd = 0, legend.mar = 4, legend.shrink = 1, legend.width = .5)
points(data.lm$precip.mean,data.lm$temp.mean,cex=.15)
points(data.lm$precip.mean,data.lm$temp.mean,pch=19,cex=.1,col='white')
mtext('Precipitation (mm per month)',1,line=2.5)
mtext('Temperature (degrees C)',2,line=2.5)
mtext(expression(beta),4,las=1,line=2.7)
dev.off()
library(fields)
jpeg('../output/beta_temp_precip_hires.jpeg',width=6.5,height=5.75,units='in',res=1000)
# pdf('../output/beta_temp_precip.pdf',width=6.5,height=5.75)
par(mar=c(3.5,3.5,1,.5),oma=rep(0,4))
image.plot(
x=seq(0,450,length.out=200),
y=seq(15,35,length.out=200),
z=matrix(
calc.beta(
rep(seq(15,35,length.out=200),each=200),
rep(seq(0,450,length.out=200),times=200)),200,200),
xlab='',
ylab='',
las=1,
lwd = 0, legend.mar = 4, legend.shrink = 1, legend.width = .5)
points(data.lm$precip.mean,data.lm$temp.mean,cex=.15)
points(data.lm$precip.mean,data.lm$temp.mean,pch=19,cex=.1,col='white')
mtext('Precipitation (mm per month)',1,line=2.5)
mtext('Temperature (degrees C)',2,line=2.5)
mtext(expression(beta),4,las=1,line=2.7)
dev.off()
